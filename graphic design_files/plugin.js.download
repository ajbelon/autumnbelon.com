!function(){function t(t,e,a){return e.type||(e.type="auto"),!(a&&!1===t.fire("beforePaste",e)||!e.dataValue&&e.dataTransfer.isEmpty())&&(e.dataValue||(e.dataValue=""),CKEDITOR.env.gecko&&"drop"==e.method&&t.toolbox&&t.once("afterPaste",(function(){t.toolbox.focus()})),t.fire("paste",e))}function e(e){function a(){var t,a=e.editable();if(CKEDITOR.plugins.clipboard.isCustomCopyCutSupported){var n=function(t){e.getSelection().isCollapsed()||(e.readOnly&&"cut"==t.name||f.initPasteDataTransfer(t,e),t.data.preventDefault())};a.on("copy",n),a.on("cut",n),a.on("cut",(function(){e.readOnly||e.extractSelectedHtml()}),null,null,999)}a.on(f.mainPasteEvent,(function(t){"beforepaste"==f.mainPasteEvent&&T||d(t)})),"beforepaste"==f.mainPasteEvent&&(a.on("paste",(function(t){g||(i(),t.data.preventDefault(),d(t),o("paste"))})),a.on("contextmenu",r,null,null,0),a.on("beforepaste",(function(t){!t.data||t.data.$.ctrlKey||t.data.$.shiftKey||r()}),null,null,0)),a.on("beforecut",(function(){!T&&s()})),a.attachListener(CKEDITOR.env.ie?a:e.document.getDocumentElement(),"mouseup",(function(){t=setTimeout((function(){u()}),0)})),e.on("destroy",(function(){clearTimeout(t)})),a.on("keyup",u)}function n(t){return{type:t,canUndo:"cut"==t,startDisabled:!0,fakeKeystroke:"cut"==t?CKEDITOR.CTRL+88:CKEDITOR.CTRL+67,exec:function(){var t;"cut"==this.type&&s();var a=this.type;if(CKEDITOR.env.ie)t=o(a);else try{t=e.document.$.execCommand(a,!1,null)}catch(e){t=!1}return t||e.showNotification(e.lang.clipboard[this.type+"Error"]),t}}}function i(){g=1,setTimeout((function(){g=0}),100)}function r(){T=1,setTimeout((function(){T=0}),10)}function o(t){var a=e.document,n=a.getBody(),i=!1,r=function(){i=!0};return n.on(t,r),7<CKEDITOR.env.version?a.$.execCommand(t):a.$.selection.createRange().execCommand(t),n.removeListener(t,r),i}function s(){if(CKEDITOR.env.ie&&!CKEDITOR.env.quirks){var t,a,n,i=e.getSelection();i.getType()==CKEDITOR.SELECTION_ELEMENT&&(t=i.getSelectedElement())&&(a=i.getRanges()[0],(n=e.document.createText("")).insertBefore(t),a.setStartBefore(n),a.setEndAfter(t),i.selectRanges([a]),setTimeout((function(){t.getParent()&&(n.remove(),i.selectElement(t))}),0))}}function l(){if("paste"==f.mainPasteEvent)return e.fire("beforePaste",{type:"auto",method:"paste"}),!1;e.focus(),i();var t=e.focusManager;return t.lock(),e.editable().fire(f.mainPasteEvent)&&!o("paste")?(t.unlock(),!1):(t.unlock(),!0)}function c(t){if("wysiwyg"==e.mode)switch(t.data.keyCode){case CKEDITOR.CTRL+86:case CKEDITOR.SHIFT+45:t=e.editable(),i(),"paste"==f.mainPasteEvent&&t.fire("beforepaste");break;case CKEDITOR.CTRL+88:case CKEDITOR.SHIFT+46:e.fire("saveSnapshot"),setTimeout((function(){e.fire("saveSnapshot")}),50)}}function d(a){var n={type:"auto",method:"paste",dataTransfer:f.initPasteDataTransfer(a)};n.dataTransfer.cacheData();var i=!1!==e.fire("beforePaste",n);i&&f.canClipboardApiBeTrusted(n.dataTransfer,e)?(a.data.preventDefault(),setTimeout((function(){t(e,n)}),0)):function(t,a){var n,i=e.document,r=e.editable(),o=function(t){t.cancel()};if(!i.getById("cke_pastebin")){var s=e.getSelection(),l=s.createBookmarks();CKEDITOR.env.ie&&s.root.fire("selectionchange");var c=new CKEDITOR.dom.element(!CKEDITOR.env.webkit&&!r.is("body")||CKEDITOR.env.ie?"div":"body",i);c.setAttributes({id:"cke_pastebin","data-cke-temp":"1"});var d=0;i=i.getWindow(),CKEDITOR.env.webkit?(r.append(c),c.addClass("cke_editable"),r.is("body")||(d=(d="static"!=r.getComputedStyle("position")?r:CKEDITOR.dom.element.get(r.$.offsetParent)).getDocumentPosition().y)):r.getAscendant(CKEDITOR.env.ie?"body":"html",1).append(c),c.setStyles({position:"absolute",top:i.getScrollPosition().y-d+10+"px",width:"1px",height:Math.max(1,i.getViewPaneSize().height-20)+"px",overflow:"hidden",margin:0,padding:0}),CKEDITOR.env.safari&&c.setStyles(CKEDITOR.tools.cssVendorPrefix("user-select","text")),(d=c.getParent().isReadOnly())?(c.setOpacity(0),c.setAttribute("contenteditable",!0)):c.setStyle("ltr"==e.config.contentsLangDirection?"left":"right","-10000px"),e.on("selectionChange",o,null,null,0),(CKEDITOR.env.webkit||CKEDITOR.env.gecko)&&(n=r.once("blur",o,null,null,-100)),d&&c.focus(),(d=new CKEDITOR.dom.range(c)).selectNodeContents(c);var u=d.select();CKEDITOR.env.ie&&(n=r.once("blur",(function(){e.lockSelection(u)})));var p=CKEDITOR.document.getWindow().getScrollPosition().y;setTimeout((function(){var t;CKEDITOR.env.webkit&&(CKEDITOR.document.getBody().$.scrollTop=p),n&&n.removeListener(),CKEDITOR.env.ie&&r.focus(),s.selectBookmarks(l),c.remove(),CKEDITOR.env.webkit&&(t=c.getFirst())&&t.is&&t.hasClass("Apple-style-span")&&(c=t),e.removeListener("selectionChange",o),a(c.getHtml())}),0)}}(0,(function(a){n.dataValue=a.replace(/<span[^>]+data-cke-bookmark[^<]*?<\/span>/gi,""),i&&t(e,n)}))}function u(){if("wysiwyg"==e.mode){var t=p("paste");e.getCommand("cut").setState(p("cut")),e.getCommand("copy").setState(p("copy")),e.getCommand("paste").setState(t),e.fire("pasteState",t)}}function p(t){if(D&&t in{paste:1,cut:1})return CKEDITOR.TRISTATE_DISABLED;if("paste"==t)return CKEDITOR.TRISTATE_OFF;var a=(t=e.getSelection()).getRanges();return t.getType()==CKEDITOR.SELECTION_NONE||1==a.length&&a[0].collapsed?CKEDITOR.TRISTATE_DISABLED:CKEDITOR.TRISTATE_OFF}var f=CKEDITOR.plugins.clipboard,T=0,g=0,D=0;!function(){if(e.on("key",c),e.on("contentDom",a),e.on("selectionChange",(function(t){D=t.data.selection.getRanges()[0].checkReadOnly(),u()})),e.contextMenu){e.contextMenu.addListener((function(t,e){return D=e.getRanges()[0].checkReadOnly(),{cut:p("cut"),copy:p("copy"),paste:p("paste")}}));var t=null;e.on("menuShow",(function(){t&&(t.removeListener(),t=null);var a=e.contextMenu.findItemByCommandName("paste");a&&a.element&&(t=a.element.on("touchend",(function(){e._.forcePasteDialog=!0})))}))}e.ui.addButton&&e.once("instanceReady",(function(){e._.pasteButtons&&CKEDITOR.tools.array.forEach(e._.pasteButtons,(function(t){(t=e.ui.get(t))&&(t=CKEDITOR.document.getById(t._.id))&&t.on("touchend",(function(){e._.forcePasteDialog=!0}))}))}))}(),function(){function a(t,a,n,i,r){var o=e.lang.clipboard[a];e.addCommand(a,n),e.ui.addButton&&e.ui.addButton(t,{label:o,command:a,toolbar:"clipboard,"+i}),e.addMenuItems&&e.addMenuItem(a,{label:o,command:a,group:"clipboard",order:r})}a("Cut","cut",n("cut"),10,1),a("Copy","copy",n("copy"),20,4),a("Paste","paste",{canUndo:!1,async:!0,fakeKeystroke:CKEDITOR.CTRL+86,exec:function(e,a){function n(a,n){n=void 0===n||n,a?(a.method="paste",a.dataTransfer||(a.dataTransfer=f.initPasteDataTransfer()),t(e,a,n)):r&&!e._.forcePasteDialog&&e.showNotification(l,"info",e.config.clipboard_notificationDuration),e._.forcePasteDialog=!1,e.fire("afterCommandExec",{name:"paste",command:i,returnValue:!!a})}var i=this,r=void 0===(a=null!=a?a:{}).notification||a.notification,o=a.type,s=CKEDITOR.tools.keystrokeToString(e.lang.common.keyboard,e.getCommandKeystroke(this)),l="string"==typeof r?r:e.lang.clipboard.pasteNotification.replace(/%1/,'<kbd aria-label="'+s.aria+'">'+s.display+"</kbd>");s="string"==typeof a?a:a.dataValue,o&&!0!==e.config.forcePasteAsPlainText&&"allow-word"!==e.config.forcePasteAsPlainText?e._.nextPasteType=o:delete e._.nextPasteType,"string"==typeof s?n({dataValue:s}):e.getClipboardData(n)}},30,8),e._.pasteButtons||(e._.pasteButtons=[]),e._.pasteButtons.push("Paste")}(),e.getClipboardData=function(t,a){function n(t){t.removeListener(),t.cancel(),a(t.data)}function i(t){t.removeListener(),t.cancel(),a({type:o,dataValue:t.data.dataValue,dataTransfer:t.data.dataTransfer,method:"paste"})}var r=!1,o="auto";a||(a=t,t=null),e.on("beforePaste",(function(t){t.removeListener(),r=!0,o=t.data.type}),null,null,1e3),e.on("paste",n,null,null,0),!1===l()&&(e.removeListener("paste",n),e._.forcePasteDialog&&r&&e.fire("pasteDialog")?(e.on("pasteDialogCommit",i),e.on("dialogHide",(function(t){t.removeListener(),t.data.removeListener("pasteDialogCommit",i),t.data._.committed||a(null)}))):a(null))}}function a(t,e){function a(t){return CKEDITOR.tools.repeat("</p><p>",~~(t/2))+(1==t%2?"<br>":"")}return e=(e=e.replace(/(?!\u3000)\s+/g," ").replace(/> +</g,"><").replace(/<br ?\/>/gi,"<br>")).replace(/<\/?[A-Z]+>/g,(function(t){return t.toLowerCase()})),e.match(/^[^<]$/)?e:(CKEDITOR.env.webkit&&-1<e.indexOf("<div>")&&((e=e.replace(/^(<div>(<br>|)<\/div>)(?!$|(<div>(<br>|)<\/div>))/g,"<br>").replace(/^(<div>(<br>|)<\/div>){2}(?!$)/g,"<div></div>")).match(/<div>(<br>|)<\/div>/)&&(e="<p>"+e.replace(/(<div>(<br>|)<\/div>)+/g,(function(t){return a(t.split("</div><div>").length+1)}))+"</p>"),e=(e=e.replace(/<\/div><div>/g,"<br>")).replace(/<\/?div>/g,"")),CKEDITOR.env.gecko&&t.enterMode!=CKEDITOR.ENTER_BR&&(CKEDITOR.env.gecko&&(e=e.replace(/^<br><br>$/,"<br>")),-1<e.indexOf("<br><br>")&&(e="<p>"+e.replace(/(<br>){2,}/g,(function(t){return a(t.length/4)}))+"</p>")),function(t,e){return t.enterMode==CKEDITOR.ENTER_BR?e=e.replace(/(<\/p><p>)+/g,(function(t){return CKEDITOR.tools.repeat("<br>",t.length/7*2)})).replace(/<\/?p>/g,""):t.enterMode==CKEDITOR.ENTER_DIV&&(e=e.replace(/<(\/)?p>/g,"<$1div>")),e}(t,e))}function n(t,e,a){e=CKEDITOR.htmlParser.fragment.fromHtml(e);var n=new CKEDITOR.htmlParser.basicWriter;return a.applyTo(e,!0,!1,t.activeEnterMode),e.writeHtml(n),n.getHtml()}function i(t){t.data.preventDefault(),t.data.$.dataTransfer.dropEffect="none"}function r(e){var a=CKEDITOR.plugins.clipboard;e.on("contentDom",(function(){function n(t,a,n){var i={$:t.data.$,target:t.data.getTarget()};a&&(i.dragRange=a),n&&(i.dropRange=n),!1===e.fire(t.name,i)&&t.data.preventDefault()}function i(t){return t.type!=CKEDITOR.NODE_ELEMENT&&(t=t.getParent()),t.getChildCount()}var r=e.editable(),o=CKEDITOR.plugins.clipboard.getDropTarget(e),s=e.ui.space("top"),l=e.ui.space("bottom");a.preventDefaultDropOnElement(s),a.preventDefaultDropOnElement(l),r.attachListener(o,"dragstart",n),r.attachListener(e,"dragstart",a.resetDragDataTransfer,a,null,1),r.attachListener(e,"dragstart",(function(t){a.initDragDataTransfer(t,e)}),null,null,2),r.attachListener(e,"dragstart",(function(){var t=a.dragRange=e.getSelection().getRanges()[0];CKEDITOR.env.ie&&10>CKEDITOR.env.version&&(a.dragStartContainerChildCount=t?i(t.startContainer):null,a.dragEndContainerChildCount=t?i(t.endContainer):null)}),null,null,100),r.attachListener(o,"dragend",n),r.attachListener(e,"dragend",a.initDragDataTransfer,a,null,1),r.attachListener(e,"dragend",a.resetDragDataTransfer,a,null,100),r.attachListener(o,"dragover",(function(t){if(CKEDITOR.env.edge)t.data.preventDefault();else{var e=t.data.getTarget();(e&&e.is&&e.is("html")||CKEDITOR.env.ie&&CKEDITOR.plugins.clipboard.isFileApiSupported&&t.data.$.dataTransfer.types.contains("Files"))&&t.data.preventDefault()}})),r.attachListener(o,"drop",(function(t){if(!t.data.$.defaultPrevented&&(t.data.preventDefault(),!(i=t.data.getTarget()).isReadOnly()||i.type==CKEDITOR.NODE_ELEMENT&&i.is("html"))){var i=a.getRangeAtDropPosition(t,e),r=a.dragRange;i&&n(t,r,i)}}),null,null,9999),r.attachListener(e,"drop",a.initDragDataTransfer,a,null,1),r.attachListener(e,"drop",(function(n){if(n=n.data){var i=n.dropRange,r=n.dragRange,o=n.dataTransfer;o.getTransferType(e)==CKEDITOR.DATA_TRANSFER_INTERNAL?setTimeout((function(){a.internalDrop(r,i,o,e)}),0):o.getTransferType(e)==CKEDITOR.DATA_TRANSFER_CROSS_EDITORS?function(a,n,i){n.select(),t(e,{dataTransfer:i,method:"drop"},1),i.sourceEditor.fire("saveSnapshot"),i.sourceEditor.editable().extractHtmlFromRange(a),i.sourceEditor.getSelection().selectRanges([a]),i.sourceEditor.fire("saveSnapshot")}(r,i,o):function(n,i){n.select(),t(e,{dataTransfer:i,method:"drop"},1),a.resetDragDataTransfer()}(i,o)}}),null,null,9999)}))}var o;CKEDITOR.plugins.add("clipboard",{requires:"dialog,notification,toolbar",lang:"af,ar,az,bg,bn,bs,ca,cs,cy,da,de,de-ch,el,en,en-au,en-ca,en-gb,eo,es,es-mx,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,oc,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,tt,ug,uk,vi,zh,zh-cn",icons:"copy,copy-rtl,cut,cut-rtl,paste,paste-rtl",hidpi:!0,init:function(t){var i,o=function(t){function e(){var t,e={};for(t in CKEDITOR.dtd)"$"!=t.charAt(0)&&"div"!=t&&"span"!=t&&(e[t]=1);return e}var a={};return{get:function(n){return"plain-text"==n?a.plainText||(a.plainText=new CKEDITOR.filter(t,"br")):"semantic-content"==n?((n=a.semanticContent)||((n=new CKEDITOR.filter(t,{})).allow({$1:{elements:e(),attributes:!0,styles:!1,classes:!1}}),n=a.semanticContent=n),n):n?new CKEDITOR.filter(t,n):null}}}(t);if(t.config.forcePasteAsPlainText?i="plain-text":t.config.pasteFilter?i=t.config.pasteFilter:!CKEDITOR.env.webkit||"pasteFilter"in t.config||(i="semantic-content"),t.pasteFilter=o.get(i),e(t),r(t),CKEDITOR.dialog.add("paste",CKEDITOR.getUrl(this.path+"dialogs/paste.js")),CKEDITOR.env.gecko){var s,l=["image/png","image/jpeg","image/gif"];t.on("paste",(function(e){var a=e.data,n=a.dataTransfer;if(!a.dataValue&&"paste"==a.method&&n&&1==n.getFilesCount()&&s!=n.id&&(n=n.getFile(0),-1!=CKEDITOR.tools.indexOf(l,n.type))){var i=new FileReader;i.addEventListener("load",(function(){e.data.dataValue='<img src="'+i.result+'" />',t.fire("paste",e.data)}),!1),i.addEventListener("abort",(function(){t.fire("paste",e.data)}),!1),i.addEventListener("error",(function(){t.fire("paste",e.data)}),!1),i.readAsDataURL(n),s=a.dataTransfer.id,e.stop()}}),null,null,1)}t.on("paste",(function(e){if(e.data.dataTransfer||(e.data.dataTransfer=new CKEDITOR.plugins.clipboard.dataTransfer),!e.data.dataValue){var a=e.data.dataTransfer,n=a.getData("text/html");n?(e.data.dataValue=n,e.data.type="html"):(n=a.getData("text/plain"))&&(e.data.dataValue=t.editable().transformPlainTextToHtml(n),e.data.type="text")}}),null,null,1),t.on("paste",(function(t){var e=t.data.dataValue,a=CKEDITOR.dtd.$block;if(-1<e.indexOf("Apple-")&&(e=e.replace(/<span class="Apple-converted-space">&nbsp;<\/span>/gi," "),"html"!=t.data.type&&(e=e.replace(/<span class="Apple-tab-span"[^>]*>([^<]*)<\/span>/gi,(function(t,e){return e.replace(/\t/g,"&nbsp;&nbsp; &nbsp;")}))),-1<e.indexOf('<br class="Apple-interchange-newline">')&&(t.data.startsWithEOL=1,t.data.preSniffing="html",e=e.replace(/<br class="Apple-interchange-newline">/,"")),e=e.replace(/(<[^>]+) class="Apple-[^"]*"/gi,"$1")),e.match(/^<[^<]+cke_(editable|contents)/i)){var n,i,r=new CKEDITOR.dom.element("div");for(r.setHtml(e);1==r.getChildCount()&&(n=r.getFirst())&&n.type==CKEDITOR.NODE_ELEMENT&&(n.hasClass("cke_editable")||n.hasClass("cke_contents"));)r=i=n;i&&(e=i.getHtml().replace(/<br>$/i,""))}CKEDITOR.env.ie?e=e.replace(/^&nbsp;(?: |\r\n)?<(\w+)/g,(function(e,n){return n.toLowerCase()in a?(t.data.preSniffing="html","<"+n):e})):CKEDITOR.env.webkit?e=e.replace(/<\/(\w+)><div><br><\/div>$/,(function(e,n){return n in a?(t.data.endsWithEOL=1,"</"+n+">"):e})):CKEDITOR.env.gecko&&(e=e.replace(/(\s)<br>$/,"$1")),t.data.dataValue=e}),null,null,3),t.on("paste",(function(e){e=e.data;var i,r=t._.nextPasteType||e.type,s=e.dataValue,l=t.config.clipboard_defaultContentType||"html",c=e.dataTransfer.getTransferType(t)==CKEDITOR.DATA_TRANSFER_EXTERNAL,d=!0===t.config.forcePasteAsPlainText;i="html"==r||"html"==e.preSniffing?"html":function(t){if(CKEDITOR.env.webkit){if(!t.match(/^[^<]*$/g)&&!t.match(/^(<div><br( ?\/)?><\/div>|<div>[^<]*<\/div>)*$/gi))return"html"}else if(CKEDITOR.env.ie){if(!t.match(/^([^<]|<br( ?\/)?>)*$/gi)&&!t.match(/^(<p>([^<]|<br( ?\/)?>)*<\/p>|(\r\n))*$/gi))return"html"}else{if(!CKEDITOR.env.gecko)return"html";if(!t.match(/^([^<]|<br( ?\/)?>)*$/gi))return"html"}return"htmlifiedtext"}(s),delete t._.nextPasteType,"htmlifiedtext"==i&&(s=a(t.config,s)),"text"==r&&"html"==i?s=n(t,s,o.get("plain-text")):(c&&t.pasteFilter&&!e.dontFilter||d)&&(s=n(t,s,t.pasteFilter)),e.startsWithEOL&&(s='<br data-cke-eol="1">'+s),e.endsWithEOL&&(s+='<br data-cke-eol="1">'),"auto"==r&&(r="html"==i||"html"==l?"html":"text"),e.type=r,e.dataValue=s,delete e.preSniffing,delete e.startsWithEOL,delete e.endsWithEOL}),null,null,6),t.on("paste",(function(e){(e=e.data).dataValue&&(t.insertHtml(e.dataValue,e.type,e.range),setTimeout((function(){t.fire("afterPaste")}),0))}),null,null,1e3),t.on("pasteDialog",(function(e){setTimeout((function(){t.openDialog("paste",e.data)}),0)}))}}),CKEDITOR.plugins.clipboard={isCustomCopyCutSupported:(!CKEDITOR.env.ie||16<=CKEDITOR.env.version)&&!CKEDITOR.env.iOS,isCustomDataTypesSupported:!CKEDITOR.env.ie||16<=CKEDITOR.env.version,isFileApiSupported:!CKEDITOR.env.ie||9<CKEDITOR.env.version,mainPasteEvent:CKEDITOR.env.ie&&!CKEDITOR.env.edge?"beforepaste":"paste",addPasteButton:function(t,e,a){t.ui.addButton&&(t.ui.addButton(e,a),t._.pasteButtons||(t._.pasteButtons=[]),t._.pasteButtons.push(e))},canClipboardApiBeTrusted:function(t,e){return!!(t.getTransferType(e)!=CKEDITOR.DATA_TRANSFER_EXTERNAL||CKEDITOR.env.chrome&&!t.isEmpty()||CKEDITOR.env.gecko&&(t.getData("text/html")||t.getFilesCount())||CKEDITOR.env.safari&&603<=CKEDITOR.env.version&&!CKEDITOR.env.iOS||CKEDITOR.env.edge&&16<=CKEDITOR.env.version)},getDropTarget:function(t){var e=t.editable();return CKEDITOR.env.ie&&9>CKEDITOR.env.version||e.isInline()?e:t.document},fixSplitNodesAfterDrop:function(t,e,a,n){function i(t,a,n){var i=t;if(i.type==CKEDITOR.NODE_TEXT&&(i=t.getParent()),i.equals(a)&&n!=a.getChildCount())return t=e.startContainer.getChild(e.startOffset-1),a=e.startContainer.getChild(e.startOffset),t&&t.type==CKEDITOR.NODE_TEXT&&a&&a.type==CKEDITOR.NODE_TEXT&&(n=t.getLength(),t.setText(t.getText()+a.getText()),a.remove(),e.setStart(t,n),e.collapse(!0)),!0}var r=e.startContainer;"number"==typeof n&&"number"==typeof a&&r.type==CKEDITOR.NODE_ELEMENT&&(i(t.startContainer,r,a)||i(t.endContainer,r,n))},isDropRangeAffectedByDragRange:function(t,e){var a=e.startContainer,n=e.endOffset;return!!(t.endContainer.equals(a)&&t.endOffset<=n||t.startContainer.getParent().equals(a)&&t.startContainer.getIndex()<n||t.endContainer.getParent().equals(a)&&t.endContainer.getIndex()<n)},internalDrop:function(e,a,n,i){var r,o,s=CKEDITOR.plugins.clipboard,l=i.editable();i.fire("saveSnapshot"),i.fire("lockSnapshot",{dontUpdate:1}),CKEDITOR.env.ie&&10>CKEDITOR.env.version&&this.fixSplitNodesAfterDrop(e,a,s.dragStartContainerChildCount,s.dragEndContainerChildCount),(o=this.isDropRangeAffectedByDragRange(e,a))||(r=e.createBookmark(!1)),s=a.clone().createBookmark(!1),o&&(r=e.createBookmark(!1)),e=r.startNode,a=r.endNode,o=s.startNode,a&&e.getPosition(o)&CKEDITOR.POSITION_PRECEDING&&a.getPosition(o)&CKEDITOR.POSITION_FOLLOWING&&o.insertBefore(e),(e=i.createRange()).moveToBookmark(r),l.extractHtmlFromRange(e,1),(a=i.createRange()).moveToBookmark(s),t(i,{dataTransfer:n,method:"drop",range:a},1),i.fire("unlockSnapshot")},getRangeAtDropPosition:function(t,e){var a=t.data.$,n=a.clientX,i=a.clientY,r=e.getSelection(!0).getRanges()[0],o=e.createRange();if(t.data.testRange)return t.data.testRange;if(document.caretRangeFromPoint&&e.document.$.caretRangeFromPoint(n,i))a=e.document.$.caretRangeFromPoint(n,i),o.setStart(CKEDITOR.dom.node(a.startContainer),a.startOffset),o.collapse(!0);else if(a.rangeParent)o.setStart(CKEDITOR.dom.node(a.rangeParent),a.rangeOffset),o.collapse(!0);else{if(CKEDITOR.env.ie&&8<CKEDITOR.env.version&&r&&e.editable().hasFocus)return r;if(!document.body.createTextRange)return null;e.focus(),a=e.document.getBody().$.createTextRange();try{for(var s=!1,l=0;20>l&&!s;l++){if(!s)try{a.moveToPoint(n,i-l),s=!0}catch(t){}if(!s)try{a.moveToPoint(n,i+l),s=!0}catch(t){}}if(s){var c="cke-temp-"+(new Date).getTime();a.pasteHTML('<span id="'+c+'">​</span>');var d=e.document.getById(c);o.moveToPosition(d,CKEDITOR.POSITION_BEFORE_START),d.remove()}else{var u=e.document.$.elementFromPoint(n,i),p=new CKEDITOR.dom.element(u);if(p.equals(e.editable())||"html"==p.getName())return r&&r.startContainer&&!r.startContainer.equals(e.editable())?r:null;n<p.getClientRect().left?o.setStartAt(p,CKEDITOR.POSITION_AFTER_START):o.setStartAt(p,CKEDITOR.POSITION_BEFORE_END),o.collapse(!0)}}catch(t){return null}}return o},initDragDataTransfer:function(t,e){var a=t.data.$?t.data.$.dataTransfer:null,n=new this.dataTransfer(a,e);"dragstart"===t.name&&n.storeId(),a?this.dragData&&n.id==this.dragData.id?n=this.dragData:this.dragData=n:this.dragData?n=this.dragData:this.dragData=n,t.data.dataTransfer=n},resetDragDataTransfer:function(){this.dragData=null},initPasteDataTransfer:function(t,e){if(this.isCustomCopyCutSupported){if(t&&t.data&&t.data.$){var a=t.data.$.clipboardData,n=new this.dataTransfer(a,e);return"copy"!==t.name&&"cut"!==t.name||n.storeId(),this.copyCutData&&n.id==this.copyCutData.id?(n=this.copyCutData).$=a:this.copyCutData=n,n}return new this.dataTransfer(null,e)}return new this.dataTransfer(CKEDITOR.env.edge&&t&&t.data.$&&t.data.$.clipboardData||null,e)},preventDefaultDropOnElement:function(t){t&&t.on("dragover",i)}},o=CKEDITOR.plugins.clipboard.isCustomDataTypesSupported?"cke/id":"Text",CKEDITOR.plugins.clipboard.dataTransfer=function(t,e){t&&(this.$=t),this._={metaRegExp:/^<meta.*?>/i,bodyRegExp:/<body(?:[\s\S]*?)>([\s\S]*)<\/body>/i,fragmentRegExp:/\x3c!--(?:Start|End)Fragment--\x3e/g,data:{},files:[],nativeHtmlCache:"",normalizeType:function(t){return"text"==(t=t.toLowerCase())||"text/plain"==t?"Text":"url"==t?"URL":t}},this._.fallbackDataTransfer=new CKEDITOR.plugins.clipboard.fallbackDataTransfer(this),this.id=this.getData(o),this.id||(this.id="Text"==o?"":"cke-"+CKEDITOR.tools.getUniqueId()),e&&(this.sourceEditor=e,this.setData("text/html",e.getSelectedHtml(1)),"Text"==o||this.getData("text/plain")||this.setData("text/plain",e.getSelection().getSelectedText()))},CKEDITOR.DATA_TRANSFER_INTERNAL=1,CKEDITOR.DATA_TRANSFER_CROSS_EDITORS=2,CKEDITOR.DATA_TRANSFER_EXTERNAL=3,CKEDITOR.plugins.clipboard.dataTransfer.prototype={getData:function(t,e){if(null==(n="text/html"==(t=this._.normalizeType(t))&&e?this._.nativeHtmlCache:this._.data[t])||""===n){if(this._.fallbackDataTransfer.isRequired())n=this._.fallbackDataTransfer.getData(t,e);else try{n=this.$.getData(t)||""}catch(t){n=""}"text/html"!=t||e||(n=this._stripHtml(n))}if("Text"==t&&CKEDITOR.env.gecko&&this.getFilesCount()&&"file://"==n.substring(0,7)&&(n=""),"string"==typeof n)var a=n.indexOf("</html>"),n=-1!==a?n.substring(0,a+7):n;return n},setData:function(t,e){if("text/html"==(t=this._.normalizeType(t))?(this._.data[t]=this._stripHtml(e),this._.nativeHtmlCache=e):this._.data[t]=e,CKEDITOR.plugins.clipboard.isCustomDataTypesSupported||"URL"==t||"Text"==t)if("Text"==o&&"Text"==t&&(this.id=e),this._.fallbackDataTransfer.isRequired())this._.fallbackDataTransfer.setData(t,e);else try{this.$.setData(t,e)}catch(t){}},storeId:function(){"Text"!==o&&this.setData(o,this.id)},getTransferType:function(t){return this.sourceEditor?this.sourceEditor==t?CKEDITOR.DATA_TRANSFER_INTERNAL:CKEDITOR.DATA_TRANSFER_CROSS_EDITORS:CKEDITOR.DATA_TRANSFER_EXTERNAL},cacheData:function(){function t(t){t=n._.normalizeType(t);var e=n.getData(t);"text/html"==t&&(n._.nativeHtmlCache=n.getData(t,!0),e=n._stripHtml(e)),e&&(n._.data[t]=e)}if(this.$){var e,a,n=this;if(CKEDITOR.plugins.clipboard.isCustomDataTypesSupported){if(this.$.types)for(e=0;e<this.$.types.length;e++)t(this.$.types[e])}else t("Text"),t("URL");if(a=this._getImageFromClipboard(),this.$&&this.$.files||a){if(this._.files=[],this.$.files&&this.$.files.length)for(e=0;e<this.$.files.length;e++)this._.files.push(this.$.files[e]);0===this._.files.length&&a&&this._.files.push(a)}}},getFilesCount:function(){return this._.files.length?this._.files.length:this.$&&this.$.files&&this.$.files.length?this.$.files.length:this._getImageFromClipboard()?1:0},getFile:function(t){return this._.files.length?this._.files[t]:this.$&&this.$.files&&this.$.files.length?this.$.files[t]:0===t?this._getImageFromClipboard():void 0},isEmpty:function(){var t,e={};if(this.getFilesCount())return!1;if(CKEDITOR.tools.array.forEach(CKEDITOR.tools.objectKeys(this._.data),(function(t){e[t]=1})),this.$)if(CKEDITOR.plugins.clipboard.isCustomDataTypesSupported){if(this.$.types)for(var a=0;a<this.$.types.length;a++)e[this.$.types[a]]=1}else e.Text=1,e.URL=1;for(t in"Text"!=o&&(e[o]=0),e)if(e[t]&&""!==this.getData(t))return!1;return!0},_getImageFromClipboard:function(){var t;if(this.$&&this.$.items&&this.$.items[0])try{if((t=this.$.items[0].getAsFile())&&t.type)return t}catch(t){}},_stripHtml:function(t){if(t&&t.length){t=t.replace(this._.metaRegExp,"");var e=this._.bodyRegExp.exec(t);e&&e.length&&(t=(t=e[1]).replace(this._.fragmentRegExp,""))}return t}},CKEDITOR.plugins.clipboard.fallbackDataTransfer=function(t){this._dataTransfer=t,this._customDataFallbackType="text/html"},CKEDITOR.plugins.clipboard.fallbackDataTransfer._isCustomMimeTypeSupported=null,CKEDITOR.plugins.clipboard.fallbackDataTransfer._customTypes=[],CKEDITOR.plugins.clipboard.fallbackDataTransfer.prototype={isRequired:function(){var t=CKEDITOR.plugins.clipboard.fallbackDataTransfer,e=this._dataTransfer.$;if(null===t._isCustomMimeTypeSupported){if(!e)return!1;if(t._isCustomMimeTypeSupported=!1,CKEDITOR.env.edge&&17<=CKEDITOR.env.version)return!0;try{e.setData("cke/mimetypetest","cke test value"),t._isCustomMimeTypeSupported="cke test value"===e.getData("cke/mimetypetest"),e.clearData("cke/mimetypetest")}catch(t){}}return!t._isCustomMimeTypeSupported},getData:function(t,e){var a=this._getData(this._customDataFallbackType,!0);if(e)return a;a=this._extractDataComment(a);var n=null;return null!==(n=t===this._customDataFallbackType?a.content:a.data&&a.data[t]?a.data[t]:this._getData(t,!0))?n:""},setData:function(t,e){(i=t===this._customDataFallbackType)&&(e=this._applyDataComment(e,this._getFallbackTypeData()));var a=e,n=this._dataTransfer.$;try{n.setData(t,a),i&&(this._dataTransfer._.nativeHtmlCache=a)}catch(e){if(this._isUnsupportedMimeTypeError(e)){i=CKEDITOR.plugins.clipboard.fallbackDataTransfer,-1===CKEDITOR.tools.indexOf(i._customTypes,t)&&i._customTypes.push(t);var i=this._getFallbackTypeContent(),r=this._getFallbackTypeData();r[t]=a;try{a=this._applyDataComment(i,r),n.setData(this._customDataFallbackType,a),this._dataTransfer._.nativeHtmlCache=a}catch(t){a=""}}}return a},_getData:function(t,e){var a=this._dataTransfer._.data;if(!e&&a[t])return a[t];try{return this._dataTransfer.$.getData(t)}catch(t){return null}},_getFallbackTypeContent:function(){var t=this._dataTransfer._.data[this._customDataFallbackType];return t||(t=this._extractDataComment(this._getData(this._customDataFallbackType,!0)).content),t},_getFallbackTypeData:function(){var t=CKEDITOR.plugins.clipboard.fallbackDataTransfer._customTypes,e=this._extractDataComment(this._getData(this._customDataFallbackType,!0)).data||{},a=this._dataTransfer._.data;return CKEDITOR.tools.array.forEach(t,(function(t){void 0!==a[t]?e[t]=a[t]:void 0!==e[t]&&(e[t]=e[t])}),this),e},_isUnsupportedMimeTypeError:function(t){return t.message&&-1!==t.message.search(/element not found/gi)},_extractDataComment:function(t){var e,a={data:null,content:t||""};t&&16<t.length&&((e=/\x3c!--cke-data:(.*?)--\x3e/g.exec(t))&&e[1]&&(a.data=JSON.parse(decodeURIComponent(e[1])),a.content=t.replace(e[0],"")));return a},_applyDataComment:function(t,e){var a="";return e&&CKEDITOR.tools.objectKeys(e).length&&(a="\x3c!--cke-data:"+encodeURIComponent(JSON.stringify(e))+"--\x3e"),a+(t&&t.length?t:"")}}}(),CKEDITOR.config.clipboard_notificationDuration=1e4;